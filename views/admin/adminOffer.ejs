<%- include('../include/adminBase.ejs') %>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css" rel="stylesheet" />

<section id="content">
  <main>
    <div class="table-data">
      <div class="order">
        <div class="head">
          <h3>Category offer</h3>
          <a href='/deleteOffers'>
            <button class="btn btn-rounded">
              <i class='bx bx-trash'></i>deleted/Expired
            </button>
          </a>
          <a href="/addOffers">
            <button class="btn btn-rounded">
              <i class='bx bx-plus'></i>Add offer
            </button>
          </a>
        </div>
        <% if (offers && offers.length > 0) { %>
        <table>
          <thead>
            <tr>
              <th>Category</th>
              <th>Discount</th>
              <th>Expires At</th>
              <th>Status</th>
              <th>Delete</th>
              <th>Update</th>
            </tr>
          </thead>
          <tbody>
            <% offers.forEach((offer, index) => { %>
              <tr>
                <td><%= offer.name %></td>
                <td><%= offer.discount %> % </td>
                <td><%= offer.expiresAt.toDateString() %></td>
                <td>
                  <span class="status cancelled" style="background-color: rgb(52, 157, 0);">
                    Active
                  </span>
                </td>
                <td>
                  <a href="/delete-Offers?id=<%= offer._id %>">
                    <i class="fas fa-trash-alt" style="color: black;"></i>
                  </a>
                </td>
                <td>
                  <a href="/updateOffers?id=<%= offer._id %>">
                    <i class="bx bx-edit" style="color: black;"></i>
                  </a>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>
   <% } else { %>
    <p>No offers available</p>
    <% } %>
      </div>
    </div>

    <!-- Pagination Controls -->
    <% if(totalPages > 0) {%>
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <% if (currentPage > 1) { %>
          <li class="page-item">
            <a class="page-link" href="?page=<%= currentPage - 1 %>&limit=<%= limit %>" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
        <% } else { %>
          <li class="page-item disabled">
            <span class="page-link" aria-hidden="true">&laquo;</span>
          </li>
        <% } %>

        <% for (let i = 1; i <= totalPages; i++) { %>
          <li class="page-item <%= i === currentPage ? 'active' : '' %>">
            <a class="page-link" href="?page=<%= i %>&limit=<%= limit %>"><%= i %></a>
          </li>
        <% } %>

        <% if (currentPage < totalPages) { %>
          <li class="page-item">
            <a class="page-link" href="?page=<%= currentPage + 1 %>&limit=<%= limit %>" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        <% } else { %>
          <li class="page-item disabled">
            <span class="page-link" aria-hidden="true">&raquo;</span>
          </li>
        <% } %>
      </ul>
    </nav>
    <% } %>
  </main>
</section>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
//  document.addEventListener('DOMContentLoaded', function () {
   
// const successMessage = "<%= successMessage %>";
//     if (successMessage) {
//       Swal.fire({
//         icon: 'success',
//         title: 'Success',
//         text: successMessage,
//       });
//     }
//   })
</script>
</body>
</html>
